#!/usr/bin/env possum

input(program)

program = ast_node("program", array_sep(expr, w))

w = maybe(whitespace)

expr =
  ast_node("apply", apply)   |
  ast_node("number", number) |
  ast_node("string", string) |
  ast_node("atom", atom)

apply = "(" > maybe_array_sep(expr, w) < ")"

non_atom_char = "(" | ")" | '"' | space | newline
atom = many_until(char, non_atom_char)

string = ('"' > default(many_until(char, '"'), "") < '"')
