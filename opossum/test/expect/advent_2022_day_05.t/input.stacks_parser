crate = "[" > char < "]"
no_crate = "   " $ null
cargo = crate | no_crate

move =
  "move" & ws & Count <- number  & ws &
  "from" & ws & From  <- numeral & ws &
  "to"   & ws & To    <- numeral & ws $
  {"count": Count, "from": From, "to": To}

CrateStacks(Labels, CargoRows) =
  CargoCols <- RotateTableClockwise(CargoRows) &
  CrateCols <- Map(Reject(null, _), CargoCols) &
  ZipObject(Labels, CargoCols)

CargoRows <- table_sep(cargo, " ", nl) &
Labels <- ws > array_sep(numeral, ws) < ws &
Steps <- array(move) $
{"stacks": CrateStacks(Labels, CargoRows), "steps": Steps}
